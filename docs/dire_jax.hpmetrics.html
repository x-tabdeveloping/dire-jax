<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>dire_jax.hpmetrics</title>
    <meta name="generator" content="pydoctor 24.11.2"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1" />
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
    
</head>

  <body>

    

    <nav class="navbar navbar-default mainnavbar">
      
  
  <div class="container-fluid">


    <div class="navbar-header">
      
      <div class="navlinks">
        <span class="navbar-brand">
          Dimensionality Reduction with JAX <a href="index.html">API Documentation</a>
        </span>

        <a href="moduleIndex.html">
          Modules
        </a>

        <a href="classIndex.html">
          Classes
        </a>

        <a href="nameIndex.html">
          Names
        </a>

        <div id="search-box-container">
          <div class="input-group">
            <input id="search-box" type="search" name="search-query" placeholder="Search..." aria-label="Search" minlength="2" class="form-control" autocomplete="off" />
            
            <span class="input-group-btn">
              <a style="display: none;" class="btn btn-default" id="search-clear-button" title="Clear" onclick="clearSearch()"><img src="fonts/x-circle.svg" alt="Clear" /></a>
              <a class="btn btn-default" id="apidocs-help-button" title="Help" href="apidocs-help.html"><img src="fonts/info.svg" alt="Help" /></a>
            </span>
          </div>
        </div>

      </div>

      <div id="search-results-container" style="display: none;">
        
        <div id="search-buttons">
          <span class="label label-default" id="search-docstrings-button">
          <label class="checkbox-inline">
            <input type="checkbox" id="toggle-search-in-docstrings-checkbox" value="false" onclick="toggleSearchInDocstrings()">
              search in docstrings
            </input>
          </label>
          </span>
          
        </div>
        
        <noscript>
            <h1>Cannot search: JavaScript is not supported/enabled in your browser.</h1>
        </noscript>

        <div id="search-status"> </div>

        <div class="warning" id="search-warn-box" style="display: none;">
          <p class="rst-last"><span id="search-warn"></span></p>
        </div>

        <table id="search-results">
          <!-- Filled dynamically by JS -->
        </table>
        
        <div style="margin-top: 10px;">
          <p>For more information on the search, visit the <a href="apidocs-help.html#rst-search">help page</a>.</p>
        </div>
      </div>

    </div>


  </div>
</nav>
    
    <div class="container-fluid">

      <!-- Side navigation -->
      <div class="sidebarcontainer" style="display: none;">
        
        <div class="sidebar"><nav class="sidebar">
  

  <div>

      <div class="thingTitle">
        <span>Module</span>
        <code class="thisobject"><a href="dire_jax.hpmetrics.html" class="internal-link" title="This module">hpmetrics</a></code> 
      </div>
      
      <div>
        

        
         

        
        

        <div class="childrenKindTitle">Functions</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="#betti_curve" class="internal-link" title="dire_jax.hpmetrics.betti_curve">betti<wbr></wbr>_curve</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_bottleneck" class="internal-link" title="dire_jax.hpmetrics.compute_bottleneck">compute<wbr></wbr>_bottleneck</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_context_measures" class="internal-link" title="dire_jax.hpmetrics.compute_context_measures">compute<wbr></wbr>_context<wbr></wbr>_measures</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_dtw" class="internal-link" title="dire_jax.hpmetrics.compute_dtw">compute<wbr></wbr>_dtw</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_emd" class="internal-link" title="dire_jax.hpmetrics.compute_emd">compute<wbr></wbr>_emd</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_global_metrics" class="internal-link" title="dire_jax.hpmetrics.compute_global_metrics">compute<wbr></wbr>_global<wbr></wbr>_metrics</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_knn_accuracy" class="internal-link" title="dire_jax.hpmetrics.compute_knn_accuracy">compute<wbr></wbr>_knn<wbr></wbr>_accuracy</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_knn_score" class="internal-link" title="dire_jax.hpmetrics.compute_knn_score">compute<wbr></wbr>_knn<wbr></wbr>_score</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_local_metrics" class="internal-link" title="dire_jax.hpmetrics.compute_local_metrics">compute<wbr></wbr>_local<wbr></wbr>_metrics</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_neighbor_score" class="internal-link" title="dire_jax.hpmetrics.compute_neighbor_score">compute<wbr></wbr>_neighbor<wbr></wbr>_score</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_quality_measures" class="internal-link" title="dire_jax.hpmetrics.compute_quality_measures">compute<wbr></wbr>_quality<wbr></wbr>_measures</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_stress" class="internal-link" title="dire_jax.hpmetrics.compute_stress">compute<wbr></wbr>_stress</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_svm_accuracy" class="internal-link" title="dire_jax.hpmetrics.compute_svm_accuracy">compute<wbr></wbr>_svm<wbr></wbr>_accuracy</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_svm_score" class="internal-link" title="dire_jax.hpmetrics.compute_svm_score">compute<wbr></wbr>_svm<wbr></wbr>_score</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_twed" class="internal-link" title="dire_jax.hpmetrics.compute_twed">compute<wbr></wbr>_twed</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#compute_wasserstein" class="internal-link" title="dire_jax.hpmetrics.compute_wasserstein">compute<wbr></wbr>_wasserstein</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#diagrams" class="internal-link" title="dire_jax.hpmetrics.diagrams">diagrams</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#make_knn_graph" class="internal-link" title="dire_jax.hpmetrics.make_knn_graph">make<wbr></wbr>_knn<wbr></wbr>_graph</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#threshold_subsample" class="internal-link" title="dire_jax.hpmetrics.threshold_subsample">threshold<wbr></wbr>_subsample</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#welford" class="internal-link" title="dire_jax.hpmetrics.welford">welford</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#welford_finalize" class="internal-link" title="dire_jax.hpmetrics.welford_finalize">welford<wbr></wbr>_finalize</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#welford_update" class="internal-link" title="dire_jax.hpmetrics.welford_update">welford<wbr></wbr>_update</a></code>
            </div>
        

    </li>
</ul> 

        
         

        
         

        
         
        
      </div>
  </div><div>

      <div class="thingTitle">
        <span>Package</span>
        <code><a href="index.html" class="internal-link" title="The parent of this module">dire<wbr></wbr>_jax</a></code> 
      </div>
      
      <div>
        

        <div class="childrenKindTitle">Modules</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="dire_jax.dire.html" class="internal-link" title="dire_jax.dire">dire</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="dire_jax.dire_utils.html" class="internal-link" title="dire_jax.dire_utils">dire<wbr></wbr>_utils</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="dire_jax.hpindex.html" class="internal-link" title="dire_jax.hpindex">hpindex</a></code>
            </div>
        

    </li><li class=" thisobject">
        
        
        

        
            <div class="itemName"><code><a href="dire_jax.hpmetrics.html" class="internal-link" title="dire_jax.hpmetrics">hpmetrics</a></code>
            </div>
        

    </li>
</ul> 

        
        

        
         

        
         

        <div class="childrenKindTitle">Variables</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="index.html#HAS_UTILS" class="internal-link" title="dire_jax.HAS_UTILS">HAS<wbr></wbr>_UTILS</a></code>
            </div>
        

    </li>
</ul> 

        
         
        
      </div>
  </div>

</nav>
        </div>
        <div id="collapseSideBar">
          <a class="btn btn-link" onclick="toggleSideBarCollapse()" title="Toggle Sidebar Collapse">
          </a>
        </div> 
        <script src="sidebartoggle.js" type="text/javascript"></script>
       
      </div>

      <div id="main" class="">
        

        

        <div class="page-header">
          <h1 class="module"><code><code><a href="index.html" class="internal-link">dire_jax</a></code><wbr></wbr>.<code><a href="dire_jax.hpmetrics.html" class="internal-link" title="dire_jax.hpmetrics">hpmetrics</a></code></code></h1>
          <div id="showPrivate">
            <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
          </div>
        </div>

        <div class="categoryHeader">
          module documentation
        </div>

        <div class="extrasDocstring">
          
          <p></p>
        </div>

        <div class="moduleDocstring">
          <div><p>Auxiliary functions for high-performance benchmarking metrics</p></div>
        </div>

        <div id="splitTables">
          <table class="children sortable" id="id8">
  
  
  <tr class="function">
    
    <td>Function</td>
    <td><code><a href="#betti_curve" class="internal-link" title="dire_jax.hpmetrics.betti_curve">betti<wbr></wbr>_curve</a></code></td>
    <td>Compute the Betti curve from a persistence diagram, which is a function of the number of features that persist at different filtration levels. This curve provides a summary of topological features across scales.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_bottleneck" class="internal-link" title="dire_jax.hpmetrics.compute_bottleneck">compute<wbr></wbr>_bottleneck</a></code></td>
    <td>Compute normalized bottleneck distance between two persistence diagrams (usually one of high-dimensional data and one of low-dimensional data).</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_context_measures" class="internal-link" title="dire_jax.hpmetrics.compute_context_measures">compute<wbr></wbr>_context<wbr></wbr>_measures</a></code></td>
    <td>Compute measures of how well the embedding preserves the context of the data.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_dtw" class="internal-link" title="dire_jax.hpmetrics.compute_dtw">compute<wbr></wbr>_dtw</a></code></td>
    <td>Compute normalized Dynamic Time Warp (DTW) distance (using Euclidean metric) between two Betti curves represented as time series with time dimension x and values y.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_emd" class="internal-link" title="dire_jax.hpmetrics.compute_emd">compute<wbr></wbr>_emd</a></code></td>
    <td>Compute normalized Earth Mover Distance (EMD) distance (using Euclidean metric) between two Betti curves represented as time series with time dimension x and values y.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_global_metrics" class="internal-link" title="dire_jax.hpmetrics.compute_global_metrics">compute<wbr></wbr>_global<wbr></wbr>_metrics</a></code></td>
    <td>Compute and compare persistence metrics between high-dimensional and low-dimensional data representations. The function calculates the Dynamic Time Warp (DTW), Time Warp Edit Distance (TWED), and Earth Mover Distance based on Betti curves derived from persistence diagrams...</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_knn_accuracy" class="internal-link" title="dire_jax.hpmetrics.compute_knn_accuracy">compute<wbr></wbr>_knn<wbr></wbr>_accuracy</a></code></td>
    <td>Compute kNN classifier accuracy for given labelled data X with labels y.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_knn_score" class="internal-link" title="dire_jax.hpmetrics.compute_knn_score">compute<wbr></wbr>_knn<wbr></wbr>_score</a></code></td>
    <td>Compute kNN score (context preservation measure) by comparing kNN classifier accuracies on the high-dimensional data and on the low-dimensional embedding.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_local_metrics" class="internal-link" title="dire_jax.hpmetrics.compute_local_metrics">compute<wbr></wbr>_local<wbr></wbr>_metrics</a></code></td>
    <td>Compute local metrics of the (data, layout) pair.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_neighbor_score" class="internal-link" title="dire_jax.hpmetrics.compute_neighbor_score">compute<wbr></wbr>_neighbor<wbr></wbr>_score</a></code></td>
    <td>Computes the neighborhood preservation score between high-dimensional data and its corresponding low-dimensional layout.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_quality_measures" class="internal-link" title="dire_jax.hpmetrics.compute_quality_measures">compute<wbr></wbr>_quality<wbr></wbr>_measures</a></code></td>
    <td>Compute quality measures for assessing the quality of dimensionality reduction.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_stress" class="internal-link" title="dire_jax.hpmetrics.compute_stress">compute<wbr></wbr>_stress</a></code></td>
    <td>Compute the stress of an embedding based on the distances in the original high-dimensional space and the embedded space, using a ratio of distances.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_svm_accuracy" class="internal-link" title="dire_jax.hpmetrics.compute_svm_accuracy">compute<wbr></wbr>_svm<wbr></wbr>_accuracy</a></code></td>
    <td>Compute linear SVM classifier accuracy for given labelled data X with labels y.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_svm_score" class="internal-link" title="dire_jax.hpmetrics.compute_svm_score">compute<wbr></wbr>_svm<wbr></wbr>_score</a></code></td>
    <td>Compute SVM score (context preservation measure) by comparing linear SVM classifier accuracies on the high-dimensional data and on the low-dimensional embedding.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_twed" class="internal-link" title="dire_jax.hpmetrics.compute_twed">compute<wbr></wbr>_twed</a></code></td>
    <td>Compute normalized Time Warp Edit Distance (TWED) distance using Euclidean metric between two Betti curves represented as time series with time dimension x and values y.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#compute_wasserstein" class="internal-link" title="dire_jax.hpmetrics.compute_wasserstein">compute<wbr></wbr>_wasserstein</a></code></td>
    <td>Compute normalized Wasserstein distance between two persistence diagrams (usually one of high-dimensional data and one of low-dimensional data).</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#diagrams" class="internal-link" title="dire_jax.hpmetrics.diagrams">diagrams</a></code></td>
    <td>Generate persistence diagrams for high-dimensional and low-dimensional data up to a specified dimension, after subsampling both datasets based on a threshold. The subsampling is performed to reduce the dataset size and potentially highlight more relevant features when computing topological summaries.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#make_knn_graph" class="internal-link" title="dire_jax.hpmetrics.make_knn_graph">make<wbr></wbr>_knn<wbr></wbr>_graph</a></code></td>
    <td>Compute the distances to nearest neighbors and their indices in the kNN graph of data.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#threshold_subsample" class="internal-link" title="dire_jax.hpmetrics.threshold_subsample">threshold<wbr></wbr>_subsample</a></code></td>
    <td>Subsample multiple arrays based on a specified threshold. The function generates random numbers and selects the samples where the random number is less than the threshold.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#welford" class="internal-link" title="dire_jax.hpmetrics.welford">welford</a></code></td>
    <td>Compute the mean and standard deviation of a dataset using Welford's algorithm.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#welford_finalize" class="internal-link" title="dire_jax.hpmetrics.welford_finalize">welford<wbr></wbr>_finalize</a></code></td>
    <td>Finalize the computation of mean and variance from the aggregate statistics.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#welford_update" class="internal-link" title="dire_jax.hpmetrics.welford_update">welford<wbr></wbr>_update</a></code></td>
    <td>Update running mean and variance using Welford's algorithm, ignoring values beyond the given finite_threshold.</td>
  </tr>
</table>
          

            
        </div>

        <div id="childList">
          <div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.betti_curve">
    
  </a>
  <a name="betti_curve">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">betti_curve</span><span class="function-signature">(diagram, n_steps=100)</span>:
    
    <a class="headerLink" href="#betti_curve" title="dire_jax.hpmetrics.betti_curve">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute the Betti curve from a persistence diagram, which is a function of the number of features
that persist at different filtration levels. This curve provides a summary of topological features
across scales.

Parameters
----------
diagram: (list of tuples) A persistence diagram represented as a list of tuples (birth, death) indicating
                          the range over which each topological feature persists.
n_steps: (int, optional) The number of steps or points in the filtration range at which to evaluate the Betti number.

Returns
-------
tuple: A tuple of two numpy arrays:
    - The first array represents the evenly spaced filtration values.
    - The second array represents the Betti numbers at each filtration value.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_bottleneck">
    
  </a>
  <a name="compute_bottleneck">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_bottleneck</span><span class="function-signature">(diag_hd, diag_ld, norm_factor=1.0)</span>:
    
    <a class="headerLink" href="#compute_bottleneck" title="dire_jax.hpmetrics.compute_bottleneck">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute normalized bottleneck distance between two persistence diagrams
(usually one of high-dimensional data and one of low-dimensional data).

Parameters
----------
diag_hd: (list of tuples) Persistence diagram for the high-dimensional data.
diag_ld: (list of tuples) Persistence diagram for the low-dimensional data.
norm_factor: (float) Normalization factor, default 1.0.

Returns
-------
float: Normalized bottleneck distance between persistence diagrams.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_context_measures">
    
  </a>
  <a name="compute_context_measures">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_context_measures</span><span class="function-signature">(data, layout, labels, subsample_threshold, n_neighbors, rng_key, **kwargs)</span>:
    
    <a class="headerLink" href="#compute_context_measures" title="dire_jax.hpmetrics.compute_context_measures">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute measures of how well the embedding preserves the context of the data.

Parameters
----------
data : numpy.ndarray
    High-dimensional data points.
layout : numpy.ndarray
    Low-dimensional embedding of the data.
labels : numpy.ndarray
    Data labels needed for context preservation analysis.
subsample_threshold : float
    Threshold used for subsampling the data.
n_neighbors : int
    Number of neighbors for the kNN graph.
rng_key : jax.random.PRNGKey
    Random key for reproducible subsampling.
**kwargs
    Additional keyword arguments for the scoring functions.

Returns
-------
dict
    Dictionary of context preservation measures, including
    SVM and kNN classification performance comparisons.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_dtw">
    
  </a>
  <a name="compute_dtw">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_dtw</span><span class="function-signature">(axis_x_hd, axis_y_hd, axis_x_ld, axis_y_ld, norm_factor=1.0)</span>:
    
    <a class="headerLink" href="#compute_dtw" title="dire_jax.hpmetrics.compute_dtw">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute normalized Dynamic Time Warp (DTW) distance (using Euclidean metric)
between two Betti curves represented as time series with time dimension x and values y.

Parameters
----------
axis_x_hd: (numpy.ndarray) Time axis of the high-dimensional Betti curve.
axis_y_hd: (numpy.ndarray) Values of the high-dimensional Betti curve.
axis_x_ld: (numpy.ndarray) Time axis of the low-dimensional Betti curve.
axis_y_ld: (numpy.ndarray) Values of the low-dimensional Betti curve.
norm_factor: (float) Normalization factor, default 1.0.

Returns
-------
float: Normalized DTW distance between two Betti curves.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_emd">
    
  </a>
  <a name="compute_emd">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_emd</span><span class="function-signature">(axis_x_hd, axis_y_hd, axis_x_ld, axis_y_ld, adjust_mass=False, norm_factor=1.0)</span>:
    
    <a class="headerLink" href="#compute_emd" title="dire_jax.hpmetrics.compute_emd">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute normalized Earth Mover Distance (EMD) distance (using Euclidean metric)
between two Betti curves represented as time series with time dimension x and values y.

Parameters
----------
axis_x_hd: (numpy.ndarray) Time axis of the high-dimensional Betti curve.
axis_y_hd: (numpy.ndarray) Values of the high-dimensional Betti curve.
axis_x_ld: (numpy.ndarray) Time axis of the low-dimensional Betti curve.
axis_y_ld: (numpy.ndarray) Values of the low-dimensional Betti curve.
adjust_mass: (bool) Use to adjust mass (by default, EMD is computed for unit mass curves);
            default `False`.
norm_factor: (float) Normalization factor, default 1.0.

Returns
-------
float: Normalized EMD distance between two Betti curves.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_global_metrics">
    
  </a>
  <a name="compute_global_metrics">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_global_metrics</span><span class="function-signature">(data, layout, dimension, subsample_threshold, rng_key, n_steps=100, metrics_only=True)</span>:
    
    <a class="headerLink" href="#compute_global_metrics" title="dire_jax.hpmetrics.compute_global_metrics">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute and compare persistence metrics between high-dimensional and low-dimensional data representations.
The function calculates the Dynamic Time Warp (DTW), Time Warp Edit Distance (TWED), and Earth Mover Distance
based on Betti curves derived from persistence diagrams. The function also calculate the Wasserstein distance
and the bottleneck distance based on persistence diagrams. This evaluation helps quantify the topological
fidelity of dimensionality reduction.

Parameters
----------
data: (numpy.ndarray) High-dimensional data points.
layout: (numpy.ndarray) Low-dimensional data points corresponding to the high-dimensional data.
dimension: (int) The maximum dimension for which to compute persistence diagrams.
subsample_threshold: (float) Threshold used for subsampling the data.
rng_key: Random key used for generating random numbers for subsampling, ensuring reproducibility.
n_steps: (int, optional) The number of steps or points in the filtration range for computing Betti curves.
metrics_only: (bool) If True, return metrics only; otherwise diagrams and Betti curves are also returned;
            default `True`.

Returns
-------
If metrics_only is True:
    dict(dict): A dictionary containing one item 'metrics' that is a dictionary of lists of computed distances for
    each of the metrics (DTW, TWED, EMD, Wasserstein, and bottleneck). Each list is populated according to the
    dimensions in which the distances were computed.
If metrics_only is False:
    dict(dict, dict, dict): A dictionary containing three items:
    - 'metrics': A dictionary of metrics, as described above;
    - 'diags': A dictionary of diagrams for the initial data and for the layout;
    - 'bettis': A dictionary of Betti curves for the initial data and for the layout.
    Each dictionary is a dictionary of lists. Each list is populated according to the dimensions in which
    the distances, diagrams, or curves were computed.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_knn_accuracy">
    
  </a>
  <a name="compute_knn_accuracy">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_knn_accuracy</span><span class="function-signature">(X, y, n_neighbors=16, test_size=0.3, random_state=42)</span>:
    
    <a class="headerLink" href="#compute_knn_accuracy" title="dire_jax.hpmetrics.compute_knn_accuracy">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute kNN classifier accuracy for given labelled data X with labels y.

Parameters
----------
X: (numpy.ndarray) Data.
y: (numpy.ndarray) Data labels.
test_size: (float) Test size (between 0.0 and 1.0) for the train / test split, default 0.3.
n_neighbors: (int) Number of neighbors for kNN classification, default 16.
random_state: (int) Random state for reproducibility, default 42.

Returns
-------
accuracy: (float) Accuracy of the KNN model on the test set.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_knn_score">
    
  </a>
  <a name="compute_knn_score">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_knn_score</span><span class="function-signature">(data, layout, labels, n_neighbors=16, **kwargs)</span>:
    
    <a class="headerLink" href="#compute_knn_score" title="dire_jax.hpmetrics.compute_knn_score">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute kNN score (context preservation measure) by comparing kNN classifier accuracies
on the high-dimensional data and on the low-dimensional embedding.

Parameters
----------
data: (numpy.ndarray)  High-dimensional data.
layout: (numpy.ndarray) Low-dimensional embedding.
labels: (numpy.ndarray) Data labels.
n_neighbors: (int) Number of nearest neighbors for kNN classifier, default 16.
kwargs: Other keyword arguments used by the various scores above.

Returns
-------
float: kNN context preservation score.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_local_metrics">
    
  </a>
  <a name="compute_local_metrics">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_local_metrics</span><span class="function-signature">(data, layout, n_neighbors, memory_efficient=None)</span>:
    
    <a class="headerLink" href="#compute_local_metrics" title="dire_jax.hpmetrics.compute_local_metrics">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute local metrics of the (data, layout) pair.

Parameters
----------
data: (numpy.ndarray) High-dimensional data points.
layout: (numpy.ndarray) Low-dimensional data points corresponding to the high-dimensional data.
n_neighbors: (int) Number of closest neighbors for the kNN graph.
memory_efficient: (bool or None) If True, use memory-efficient algorithms for large datasets.
                 If None, automatically determine based on dataset size.

Returns
-------
dict: A dictionary containing computed scores of each type (stress, neighborhood preservation).</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_neighbor_score">
    
  </a>
  <a name="compute_neighbor_score">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_neighbor_score</span><span class="function-signature">(data, layout, n_neighbors)</span>:
    
    <a class="headerLink" href="#compute_neighbor_score" title="dire_jax.hpmetrics.compute_neighbor_score">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Computes the neighborhood preservation score between high-dimensional data and its corresponding low-dimensional
layout.

The function evaluates how well the neighborhood relationships are preserved when data is projected from
a high-dimensional space to a lower-dimensional space using the K-nearest neighbors approach. This involves
comparing the nearest neighbors in the original space with those in the reduced space.

Parameters
----------
data: (numpy.ndarray) A NumPy array of shape (n_samples, data_dim) containing
                    the original high-dimensional data.
layout: (numpy.ndarray) A NumPy array of shape (n_samples, embed_dim) containing
                    the lower-dimensional embedding of the data.
n_neighbors: (int) The number of nearest neighbors to consider for each data point.

Returns
-------
list: A list containing two floats:
      - neighbor_mean: (float) The mean of the neighborhood preservation scores.
      - neighbor_std: (float) The standard deviation of the neighborhood preservation scores.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_quality_measures">
    
  </a>
  <a name="compute_quality_measures">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_quality_measures</span><span class="function-signature">(data, layout, n_neighbors=None)</span>:
    
    <a class="headerLink" href="#compute_quality_measures" title="dire_jax.hpmetrics.compute_quality_measures">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute quality measures for assessing the quality of dimensionality reduction.

This function calculates various metrics that evaluate how well the low-dimensional
representation preserves important properties of the high-dimensional data.

Parameters
----------
data : numpy.ndarray
    High-dimensional data points.
layout : numpy.ndarray
    Low-dimensional embedding of the data.
    
Returns
-------
dict
    Dictionary of quality measures including:
    - trustworthiness: Measures if points that are close in the embedding are also close in original space
    - continuity: Measures if points that are close in original space are also close in the embedding
    - shepard_correlation: Correlation between pairwise distances in original and embedded spaces</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_stress">
    
  </a>
  <a name="compute_stress">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_stress</span><span class="function-signature">(data, layout, n_neighbors, eps=1e-06)</span>:
    
    <a class="headerLink" href="#compute_stress" title="dire_jax.hpmetrics.compute_stress">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute the stress of an embedding based on the distances in the original high-dimensional
space and the embedded space, using a ratio of distances.

Parameters
----------
data: (numpy.ndarray) High-dimensional data points.
layout: (numpy.ndarray) Embedded data points.
n_neighbors: (int) Number of nearest neighbors to consider for each point.
eps: (float) Parameter to prevent zero division if mean distortion is near zero, default 1e-6.

Returns
-------
float: The normalized stress value indicating the quality of the embedding.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_svm_accuracy">
    
  </a>
  <a name="compute_svm_accuracy">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_svm_accuracy</span><span class="function-signature">(X, y, test_size=0.3, reg_param=1.0, max_iter=100, random_state=42)</span>:
    
    <a class="headerLink" href="#compute_svm_accuracy" title="dire_jax.hpmetrics.compute_svm_accuracy">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute linear SVM classifier accuracy for given labelled data X with labels y.

Parameters
----------
X: (numpy.ndarray) Data.
y: (numpy.ndarray) Data labels.
test_size: (float) Test size (between 0.0 and 1.0) for the train / test split, default 0.3.
reg_param: (float) Regularization parameter for SVM, default 1.0.
max_iter: (int) Maximal number of iterations for SVM training, default 100.
random_state: (int) Random state for reproducibility, default 42.

Returns
-------
float: Accuracy of the linear SVM model on the test set.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_svm_score">
    
  </a>
  <a name="compute_svm_score">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_svm_score</span><span class="function-signature">(data, layout, labels, subsample_threshold, rng_key, **kwargs)</span>:
    
    <a class="headerLink" href="#compute_svm_score" title="dire_jax.hpmetrics.compute_svm_score">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute SVM score (context preservation measure) by comparing linear SVM classifier accuracies
on the high-dimensional data and on the low-dimensional embedding.

Parameters
----------
data: (numpy.ndarray)  High-dimensional data.
layout: (numpy.ndarray) Low-dimensional embedding.
labels: (numpy.ndarray) Data labels.
subsample_threshold: (float) Threshold used for subsampling the data.
rng_key: Random key used for generating random numbers for subsampling, ensuring reproducibility.
kwargs: Other keyword arguments used by the various scores above.

Returns
-------
float: SVM context preservation score.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_twed">
    
  </a>
  <a name="compute_twed">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_twed</span><span class="function-signature">(axis_x_hd, axis_y_hd, axis_x_ld, axis_y_ld, norm_factor=1.0)</span>:
    
    <a class="headerLink" href="#compute_twed" title="dire_jax.hpmetrics.compute_twed">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute normalized Time Warp Edit Distance (TWED) distance using Euclidean metric
between two Betti curves represented as time series with time dimension x and values y.

Parameters
----------
axis_x_hd: (numpy.ndarray) Time axis of the high-dimensional Betti curve.
axis_y_hd: (numpy.ndarray) Values of the high-dimensional Betti curve.
axis_x_ld: (numpy.ndarray) Time axis of the low-dimensional Betti curve.
axis_y_ld: (numpy.ndarray) Values of the low-dimensional Betti curve.
norm_factor: (float) Normalization factor, default 1.0.

Returns
-------
float: Normalized TWED distance between two Betti curves.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.compute_wasserstein">
    
  </a>
  <a name="compute_wasserstein">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">compute_wasserstein</span><span class="function-signature">(diag_hd, diag_ld, norm_factor=1.0)</span>:
    
    <a class="headerLink" href="#compute_wasserstein" title="dire_jax.hpmetrics.compute_wasserstein">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute normalized Wasserstein distance between two persistence diagrams
(usually one of high-dimensional data and one of low-dimensional data).

Parameters
----------
diag_hd: (list of tuples) Persistence diagram for the high-dimensional data.
diag_ld: (list of tuples) Persistence diagram for the low-dimensional data.
norm_factor: (float) Normalization factor, default 1.0.

Returns
-------
float: Normalized Wasserstein distance between persistence diagrams.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.diagrams">
    
  </a>
  <a name="diagrams">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">diagrams</span><span class="function-signature">(data, layout, max_dim, subsample_threshold, rng_key)</span>:
    
    <a class="headerLink" href="#diagrams" title="dire_jax.hpmetrics.diagrams">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Generate persistence diagrams for high-dimensional and low-dimensional data up to a specified dimension,
after subsampling both datasets based on a threshold. The subsampling is performed to reduce the dataset size
and potentially highlight more relevant features when computing topological summaries.

Parameters
----------
data: (numpy.ndarray) High-dimensional data points.
layout: (numpy.ndarray) Low-dimensional data points corresponding to the high-dimensional data.
max_dim: (int) Maximum dimension of homology groups to compute.
subsample_threshold: (float) Threshold used for subsampling the data points.
rng_key: Random key used for generating random numbers for subsampling, ensuring reproducibility.

Returns
-------
dict: A dictionary containing two keys, 'data' and 'layout', each associated with arrays of persistence diagrams
      for the respective high-dimensional and low-dimensional datasets.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.make_knn_graph">
    
  </a>
  <a name="make_knn_graph">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">make_knn_graph</span><span class="function-signature">(data, n_neighbors, batch_size=None)</span>:
    
    <a class="headerLink" href="#make_knn_graph" title="dire_jax.hpmetrics.make_knn_graph">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute the distances to nearest neighbors and their indices in the kNN graph of data.

Parameters
----------
data : numpy.ndarray
    High-dimensional data points.
n_neighbors : int
    Number of nearest neighbors to find for each point.
batch_size : int or None, optional
    Number of samples to process at once. If None, a suitable value
    will be automatically determined based on dataset size.

Returns
-------
numpy.ndarray, numpy.ndarray
    Tuple containing:
    - distances: Array of shape (n_samples, n_neighbors+1) with distances to nearest neighbors
    - indices: Array of shape (n_samples, n_neighbors+1) with indices of nearest neighbors
    
    The first column contains each point's self-reference (distance 0.0 and own index).
    The remaining columns contain the n_neighbors nearest neighbors in ascending order of distance.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.threshold_subsample">
    
  </a>
  <a name="threshold_subsample">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">threshold_subsample</span><span class="function-signature">(*arrays, threshold, rng_key)</span>:
    
    <a class="headerLink" href="#threshold_subsample" title="dire_jax.hpmetrics.threshold_subsample">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Subsample multiple arrays based on a specified threshold.
The function generates random numbers and selects the samples where the random number is less than the threshold.

Parameters
----------
*arrays: (tuple of numpy.ndarray)
    The input data arrays to be subsampled. Each array should have the same number of samples (rows).
threshold: (float)
    Probability threshold for subsampling; only samples with generated random numbers below this value are kept.
rng_key: Random key or random generator used for generating random numbers, ensuring reproducibility.

Returns
-------
tuple: A tuple containing the subsampled arrays in the same order as the input arrays.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.welford">
    
  </a>
  <a name="welford">
    
  </a>
  <div class="functionHeader">
    
    @jit<br />
    <span class="py-keyword">def</span> <span class="py-defname">welford</span><span class="function-signature">(data)</span>:
    
    <a class="headerLink" href="#welford" title="dire_jax.hpmetrics.welford">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute the mean and standard deviation of a dataset using Welford's algorithm.

Parameters
----------
data: (jax.numpy.ndarray) An array of data points, potentially containing NaNs which are ignored.

Returns
-------
tuple: A tuple containing the mean and standard deviation of the valid entries in the dataset.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.welford_finalize">
    
  </a>
  <a name="welford_finalize">
    
  </a>
  <div class="functionHeader">
    
    @jit<br />
    <span class="py-keyword">def</span> <span class="py-defname">welford_finalize</span><span class="function-signature">(agg)</span>:
    
    <a class="headerLink" href="#welford_finalize" title="dire_jax.hpmetrics.welford_finalize">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Finalize the computation of mean and variance from the aggregate statistics.

Parameters
----------
agg: (tuple) A tuple containing the aggregated statistics:
             - count: (int) The total count of valid (non-NaN) entries.
             - mean: (float) The computed mean of the dataset.
             - M2: (float) The computed sum of squares of differences from the mean.

Returns
-------
tuple: A tuple containing the final mean and standard deviation of the dataset.</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="dire_jax.hpmetrics.welford_update">
    
  </a>
  <a name="welford_update">
    
  </a>
  <div class="functionHeader">
    
    @jit<br />
    <span class="py-keyword">def</span> <span class="py-defname">welford_update</span><span class="function-signature">(carry, new_value, finite_threshold=1000000000000.0)</span>:
    
    <a class="headerLink" href="#welford_update" title="dire_jax.hpmetrics.welford_update">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Update running mean and variance using Welford's algorithm,
ignoring values beyond the given finite_threshold.

Parameters
----------
carry : tuple(int, float, float)
    (count, mean, M2) — intermediate stats.
new_value : float
    Incoming value to incorporate.
finite_threshold : float
    Max magnitude allowed for inclusion.

Returns
-------
(carry, None): Updated carry and dummy output for lax.scan.</p></div>
  </div>
</div>
        </div>
      
      </div>
    </div>

    <footer class="navbar navbar-default">

  
  <div class="container-fluid">
    <a href="index.html">API Documentation</a> for Dimensionality Reduction with JAX,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    24.11.2 at 2025-05-18 20:07:07.
  </div>

  <!-- Search related scripts needs to be loaded at the end of HTML 
    parsing not to introduce overhead and display HTML data asap -->
  <script src="ajax.js" type="text/javascript"></script>
  <script src="searchlib.js" type="text/javascript"></script>
  <script src="search.js" type="text/javascript"></script>

</footer>
  
    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>